import{d as e,c as t,r as a,i as o,I as l,m as n,u as s,a as u,b as i,o as r,w as c,_ as d,R as m,e as p,f as v,g as y,h,v as b,j as f,F as g,k,l as _,p as K,n as R,q as w,s as L,t as A,x as T,y as C,z as O,A as N,B as E,T as S,K as U,C as j,D as I,E as M,G as x,H as P,J as B}from"./index.6ff52ee0.js";const q=e({components:{},props:{router:{type:Object,required:!0}},render(){const e=n=>n.routes&&!n.meta.hidden?(o=>{var n,s;const u=null!=(s=null==(n=null==o?void 0:o.meta)?void 0:n.title)?s:"unknown",i={title:()=>[t("span",{title:u},[u])],icon:()=>{var e;return[t("span",{title:u},[t(l,{icon:null!=(e=o.icon)?e:"FolderOpenOutlined"},null)])]}};return t(a("a-sub-menu"),{key:o.name},{default:()=>[o.routes&&o.routes.map((t=>e(t)))],...i})})(n):n.meta.hidden?void 0:(e=>{var n,s;const u=null!=(s=null==(n=null==e?void 0:e.meta)?void 0:n.title)?s:"unknown",i={icon:()=>{var a;return[t(l,{icon:null!=(a=e.icon)?a:"UnorderedListOutlined"},null)]}};return t(a("a-menu-item"),{key:e.name,title:u},{default:()=>{return[t(a("router-link"),{to:e.path},(l=u,"function"==typeof l||"[object Object]"===Object.prototype.toString.call(l)&&!o(l)?u:{default:()=>[u]}))];var l},...i})})(n);return e(this.router)}}),H=""+new URL("logo.03d6d6da.png",import.meta.url).href,$=e({name:"LayoutMenu",computed:{...n({menuRouter:e=>e.user.routes})},components:{MenuItem:q},props:{collapsed:{required:!0,type:Boolean}},setup(){s();const e=u(),t=i([]),a=i([]),o=()=>{e.meta.hidden||(t.value=[e.name],a.value=m[e.name].openKeys)};return r(o),c(e,o),{selectedKeys:t,openKeys:a}}}),F={class:"menu-logo"},z=(e=>(K("data-v-7ac1ae76"),e=e(),R(),e))((()=>y("div",{class:"menu-logo-icon"},[y("img",{src:H})],-1)));const G=d($,[["render",function(e,o,l,n,s,u){const i=a("menu-item"),r=a("a-menu");return p(),v("div",null,[y("div",F,[z,h(y("span",null,"通用管理后台",512),[[b,!e.collapsed]])]),t(r,{triggerSubMenuAction:"click",theme:"dark",mode:"inline",selectedKeys:e.selectedKeys,"onUpdate:selectedKeys":o[0]||(o[0]=t=>e.selectedKeys=t),openKeys:e.openKeys,"onUpdate:openKeys":o[1]||(o[1]=t=>e.openKeys=t),ref:"menu"},{default:f((()=>[(p(!0),v(g,null,k(e.menuRouter,(e=>(p(),_(i,{router:e,key:e.name},null,8,["router"])))),128))])),_:1},8,["selectedKeys","openKeys"])])}],["__scopeId","data-v-7ac1ae76"]]),Y=e({name:"LayoutTabs",computed:{...n({tabList:e=>e.tabs.tabList,includeList:e=>e.keepAlive.includeList})},setup(){let e=i();const t=s(),a=u(),o=w(),l=e=>{var a,o;t.commit("tabs/addTab",{fullPath:e.fullPath,path:e.path,name:e.name,keepAliveName:null!=(o=null==(a=null==e?void 0:e.meta)?void 0:a.keepAliveName)?o:e.name,title:e.meta.title})},n=e=>{var a;const o=null!=(a=e.meta.keepAliveName)?a:e.name;e.meta.keepAlive?t.commit("keepAlive/addKeepAlive",o):t.commit("keepAlive/removeKeepAlive",o)};c(a,(a=>{a.meta.hidden||(l(a),n(a),e.value=a.path,t.commit("settings/setSettings",{lastRoute:a.fullPath})),p()})),L(((e,t,a)=>{t.meta.hidden||(null!=t.meta.defaultKeepAlive&&(t.meta.keepAlive=t.meta.defaultKeepAlive),n(t)),a()})),r((()=>{l(a),n(a),e.value=a.path,t.commit("settings/setSettings",{lastRoute:a.fullPath}),p()}));const d=A("showRoute"),m=i(!1);c(t.state.tabs.tabList,(e=>{p()}));const p=()=>{T((()=>{m.value=1===t.state.tabs.tabList.length,t.commit("tabs/storageTabs"),setTimeout((()=>{v()}),0)}))},v=()=>{var e;let a=[];null==(e=t.state.keepAlive.includeList)||e.forEach((e=>{t.state.tabs.tabList.every((t=>t.keepAliveName!==e))&&a.push(e)})),null==a||a.forEach((e=>{t.commit("keepAlive/removeKeepAlive",e)}))};return{activeKey:e,jump:e=>{if(a.path!==e){let a=t.state.tabs.tabList.find((t=>t.path===e));o.push(a.fullPath)}},removeTab:(e,a)=>{"remove"===a&&t.commit("tabs/removeTab",e),p()},condition:(e,a,o)=>{switch(o.key){case"refresh":t.commit("tabs/refreshTab",a);break;case"current":t.commit("tabs/removeTab",e.path);break;case"right":t.commit("tabs/removeRight",a);break;case"left":t.commit("tabs/removeLeft",a);break;case"other":t.commit("tabs/removeOther",a)}p()},showRoute:d,onlyChild:m}}}),D={style:{display:"inline-block"}},J={class:"main-container"},Q={key:0,class:"loading"};const V=d(Y,[["render",function(e,o,l,n,s,u){const i=a("a-menu-item"),r=a("a-menu"),c=a("a-dropdown"),d=a("a-tab-pane"),m=a("a-tabs"),h=a("a-spin"),b=a("router-view");return p(),v("div",null,[t(m,{activeKey:e.activeKey,"onUpdate:activeKey":o[0]||(o[0]=t=>e.activeKey=t),type:"editable-card",tabBarGutter:3,onTabClick:e.jump,onEdit:e.removeTab,"hide-add":"",class:N(["tabs-view",{"only-child":e.onlyChild}])},{default:f((()=>[(p(!0),v(g,null,k(e.tabList,((a,o)=>(p(),_(d,{key:a.path},{tab:f((()=>[t(c,{trigger:["contextmenu"]},{overlay:f((()=>[t(r,{onClick:t=>e.condition(a,o,t)},{default:f((()=>[t(i,{key:"refresh"},{default:f((()=>[C("刷新标签")])),_:1}),t(i,{key:"current"},{default:f((()=>[C("删除标签")])),_:1}),t(i,{key:"right"},{default:f((()=>[C("关闭右侧")])),_:1}),t(i,{key:"left"},{default:f((()=>[C("关闭左侧")])),_:1}),t(i,{key:"other"},{default:f((()=>[C("关闭其他")])),_:1})])),_:2},1032,["onClick"])])),default:f((()=>[y("div",D,O(a.title),1)])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["activeKey","onTabClick","onEdit","class"]),y("div",J,[e.showRoute?E("",!0):(p(),v("div",Q,[t(h,{tip:"Loading...",spinning:!e.showRoute,size:"large"},null,8,["spinning"])])),e.showRoute?(p(),_(b,{key:1},{default:f((({Component:a})=>[t(S,{name:"fade",mode:"out-in"},{default:f((()=>[(p(),_(U,{max:20,include:e.includeList},[(p(),_(j(a),{key:e.$route.params.refresh}))],1032,["include"]))])),_:2},1024)])),_:1})):E("",!0)])])}],["__scopeId","data-v-291da59e"]]),W=e({name:"HeaderBtns",setup(){const e=s(),t=w(),a=u();return{routeKeys:i(Object.keys(I)),activeRouteKey:()=>e.state.user.routeKey,ROUTE_KEYS_NAME:I,changeSubRoutes:o=>{e.commit("user/setRouteKey",o),e.commit("tabs/clearTabs"),t.push(M).then((()=>{var t,o;e.commit("tabs/addTab",{fullPath:a.fullPath,path:a.path,name:a.name,keepAliveName:null!=(o=null==(t=null==a?void 0:a.meta)?void 0:t.keepAliveName)?o:a.name,title:a.meta.title}),e.commit("tabs/storageTabs")}))}}}}),X={key:0,class:"header-btns-view"};const Z=d(W,[["render",function(e,t,o,l,n,s){const u=a("a-button");return e.routeKeys.length>1?(p(),v("div",X,[(p(!0),v(g,null,k(e.routeKeys,(t=>(p(),_(u,{style:{margin:"0 5px"},type:"primary",shape:"round",key:t,ghost:"",onClick:a=>e.changeSubRoutes(t),disabled:t==e.activeRouteKey()},{default:f((()=>[C(O(e.ROUTE_KEYS_NAME[t]),1)])),_:2},1032,["onClick","disabled"])))),128))])):E("",!0)}],["__scopeId","data-v-98261954"]]),ee=""+new URL("icon.057ee6ba.png",import.meta.url).href,te=e({name:"LayoutHeader",components:{HeaderBtns:Z},computed:{...n({name:e=>e.user.name,avatar:e=>e.user.avatar})},emits:["update:collapsed"],props:{collapsed:{required:!0,type:Boolean}},setup(){const e=s(),{proxy:t}=P();return{logout:()=>{e.dispatch("user/logout").then((e=>{null==t||t.$message.success(e),x.go(0)}))},showRoute:A("showRoute"),reloadRoute:A("reloadRoute"),collapsedChange:a=>{null==t||t.$emit("update:collapsed",a),e.commit("settings/setSettings",{collapsed:a})}}}}),ae={class:"layout-header"},oe={class:"header-left"},le={class:"header-right"},ne={class:"header-avatar"},se=["src"],ue={key:1,src:ee},ie={class:"header-avatar-name"};const re=d(te,[["render",function(e,o,l,n,s,u){const i=a("Icon"),r=a("header-btns"),c=a("a-button"),d=a("a-avatar"),m=a("a-menu-item"),h=a("a-menu"),b=a("a-dropdown");return p(),v("div",ae,[y("div",oe,[e.collapsed?(p(),_(i,{key:0,icon:"MenuUnfoldOutlined",class:"trigger",onClick:o[0]||(o[0]=t=>e.collapsedChange(!e.collapsed))})):(p(),_(i,{key:1,icon:"MenuFoldOutlined",class:"trigger",onClick:o[1]||(o[1]=t=>e.collapsedChange(!e.collapsed))})),t(r)]),y("div",le,[t(c,{type:"ghost",shape:"circle",loading:!e.showRoute,onClick:e.reloadRoute},{icon:f((()=>[t(i,{icon:"RedoOutlined"})])),_:1},8,["loading","onClick"]),t(b,{trigger:["click"]},{overlay:f((()=>[t(h,{triggerSubMenuAction:"click"},{default:f((()=>[t(m,{key:"logout",onClick:o[2]||(o[2]=t=>e.logout())},{icon:f((()=>[t(i,{icon:"PoweroffOutlined"})])),default:f((()=>[C(" 退出登录 ")])),_:1})])),_:1})])),default:f((()=>[y("div",ne,[t(d,null,{icon:f((()=>[e.avatar.length>0?(p(),v("img",{key:0,src:e.avatar},null,8,se)):(p(),v("img",ue))])),_:1}),y("div",ie,O(e.name.length>0?e.name:"unknown"),1)])])),_:1})])])}],["__scopeId","data-v-4989a15f"]]),ce=e({name:"LayoutNav",setup(){s();const e=u(),t=i(m[e.name].breadcrumbRoutes);return c(e,(e=>{t.value=m[e.name].breadcrumbRoutes})),{routes:t}}}),de={class:"breadcrumb-view"},me={key:0};const pe=d(e({name:"Layout",components:{LayoutMenu:G,LayoutHeader:re,LayoutTabs:V,LayoutNav:d(ce,[["render",function(e,o,l,n,s,u){const i=a("Icon"),r=a("router-link"),c=a("a-breadcrumb");return p(),v("div",de,[t(c,{routes:e.routes},{itemRender:f((({route:a,paths:o})=>[e.routes.indexOf(a)!==e.routes.length-1&&a.path?(p(),_(r,{key:1,to:`/${o.join("/")}`},{default:f((()=>[t(i,{icon:a.icon},null,8,["icon"]),C(" "+O(a.breadcrumbName),1)])),_:2},1032,["to"])):(p(),v("span",me,[t(i,{icon:a.icon},null,8,["icon"]),C(" "+O(a.breadcrumbName),1)]))])),_:1},8,["routes"])])}]])},setup(){const e=s(),t=i(!1);t.value=e.state.settings.collapsed;const a=i(!0);return B("reloadRoute",(()=>{a.value=!1,T((()=>{setTimeout((()=>{a.value=!0}),500)}))})),B("showRoute",a),{collapsed:t,backTopTarget:()=>document.querySelector("main")}}}),[["render",function(e,o,l,n,s,u){const i=a("layout-menu"),r=a("a-layout-sider"),c=a("layout-header"),d=a("a-layout-header"),m=a("layout-nav"),v=a("layout-tabs"),y=a("a-layout-content"),h=a("a-layout"),b=a("a-back-top"),g=a("a-tooltip");return p(),_(h,{class:"layout"},{default:f((()=>[t(r,{width:"256",collapsed:e.collapsed,"onUpdate:collapsed":o[0]||(o[0]=t=>e.collapsed=t),trigger:null,collapsible:""},{default:f((()=>[t(i,{collapsed:e.collapsed},null,8,["collapsed"])])),_:1},8,["collapsed"]),t(h,null,{default:f((()=>[t(d,{class:"header"},{default:f((()=>[t(c,{collapsed:e.collapsed,"onUpdate:collapsed":o[1]||(o[1]=t=>e.collapsed=t)},null,8,["collapsed"])])),_:1}),t(y,{class:"container"},{default:f((()=>[t(m),t(v)])),_:1})])),_:1}),t(g,{placement:"top","arrow-point-at-center":""},{title:f((()=>[C("回到顶部")])),default:f((()=>[t(b,{target:e.backTopTarget},null,8,["target"])])),_:1})])),_:1})}],["__scopeId","data-v-072d783b"]]);export{pe as default};
